<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.df7b4002be4a4c015ce8ff80c38ccbff853a24c4d68c22dc037a82d535502b7548e212005b172be5343bf3365bef1058b1c907883ee167c15c592eb78118adc8.css integrity="sha512-33tAAr5KTAFc6P+Aw4zL/4U6JMTWjCLcA3qC1TVQK3VI4hIAWxcr5TQ78zZb7xBYsckHiD7hZ8FcWS63gRityA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=stylesheet href=/style.css><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Stealthy GPS Tracker & Drive-By Telemetry Using Open Wi-Fi - Alex Lynd</title><meta name=description content="Doks comes with commands for common tasks."><link rel=canonical href=/projects/dns-driveby/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Stealthy GPS Tracker & Drive-By Telemetry Using Open Wi-Fi"><meta property="og:description" content="Doks comes with commands for common tasks."><meta property="og:url" content="/projects/dns-driveby/"><meta property="og:site_name" content="Alex Lynd"><meta property="article:published_time" content="2022-10-15T08:28:16-07:00"><meta property="article:modified_time" content="2022-10-15T08:28:16-07:00"><meta property="og:image" content="/me.png"><meta property="og:image:alt" content="Alex Lynd"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@alexlynd"><meta name=twitter:creator content="@alexlynd"><meta name=twitter:title content="Stealthy GPS Tracker & Drive-By Telemetry Using Open Wi-Fi"><meta name=twitter:description content="Doks comes with commands for common tasks."><meta name=twitter:image content="/me.png"><meta name=twitter:image:alt content="Stealthy GPS Tracker & Drive-By Telemetry Using Open Wi-Fi"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"Doks","url":"/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"Alex Lynd","description":"Alex Lynd is a cybersecurity content creator, hardware hacker, and open-source product developer.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/projects/dns-driveby/","url":"/projects/dns-driveby/","name":"Stealthy GPS Tracker \u0026 Drive-By Telemetry Using Open Wi-Fi","description":"Doks comes with commands for common tasks.","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2022-10-15T08:28:16CET","dateModified":"2022-10-15T08:28:16CET","breadcrumb":{"@id":"/projects/dns-driveby/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/projects/dns-driveby/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/projects/dns-driveby/"]}]},{"@type":"BreadcrumbList","@id":"/projects/dns-driveby/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/projectsdns-driveby/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/projects/dns-driveby/#/schema/image/2","url":"/me.png","contentUrl":"/me.png","caption":"Stealthy GPS Tracker \u0026 Drive-By Telemetry Using Open Wi-Fi"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="projects single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Alex Lynd">Alex Lynd</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Alex Lynd</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><h1>Stealthy GPS Tracker & Drive-By Telemetry Using Open Wi-Fi</h1><iframe width=100% height=340 src="https://www.youtube.com/embed/H0Nwff0KDJ0?start=151" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><hr><p><em>This article is incomplete! If you&rsquo;re reading this, you&rsquo;re probably not allowed to >:(</em></p><h2 id=low-cost-tracking-challenge>Low-Cost Tracking Challenge <a href=#low-cost-tracking-challenge class=anchor aria-hidden=true></a></h2><p>In a recent Hak5 episode, I took part in a challenge to track our elusive friend, Irish, and determine the various places he visited throughout the day.</p><p>Since low-cost hardware & disposable signals intelligence is a core part of my projects, I challenged myself to create a tracker in the smallest practical footprint, and designed a $10 device that uses <em>only</em> WiFi to provide location updates once planted on Irish&rsquo;s car.</p><p>Using DNS Exfiltration, <a href=https://canarytokens.org>CanaryTokens</a>, and an ESP8266 with specialized low-power hardware, I created a motion activated tracker that could transmit intermittent location updates, by connecting to open Wi-Fi networks that Irish would drive past.</p><p>In this post, I&rsquo;ll talk about the design process of DNS DriveBy: a $10 proof-of-concept & wardriving technique that uses open Wi-Fi networks to provide location data, Wi-Fi reconnaissance, and other telemetry.</p><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png></p><h6 id=resources>Resources <a href=#resources class=anchor aria-hidden=true></a></h6><ul><li><a href=https://github.com/alexlynd/DNS-DriveBy>Source Code: GitHub</a></li></ul><h2 id=mapping-wifi-devices-with-wardriving>Mapping WiFi Devices with Wardriving <a href=#mapping-wifi-devices-with-wardriving class=anchor aria-hidden=true></a></h2><p>Wardriving is my favorite lazy reconnaissance technique, since I can aimlessly <a href>skate around</a> and create an interactive map of vulnerable networks, IOT products, and various other devices in our wireless landscape.</p><p>I&rsquo;ve toyed with the idea of creating &ldquo;disposable wardriving payloads&rdquo; that I can slap on (my) car or a neighborhood cat (or anything that moves really), so I could get even lazier with collecting WiFi intelligence - and created a <a href>$10 wardriving rig</a> using minimal components, making it accessible for anyone to replicate.</p><p>I&rsquo;ve used it to demonstrate how hackers can <a href>phish your company with a mail parcel</a>, and even <a href>strapped it to a drone for warflying</a> - but one obvious limitation lies in its inability to provide real-time telemetry for tracking applications, since it only uses a Wi-Fi radio.</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_390e4fc62d5f863feecda177f759c2c6.webp 480w, /projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_26e98f45f37476e518796c4a21b043ef.webp 720w, /projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_4a6f301e2b059e23328bca512f67622b.webp 1080w, /projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_546563e63e6cb323522f3a628bf42059.webp 1280w, /projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_e1bb8ae9e81274077faef6ad97bf40f9.webp 1600w, /projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_1920x0_resize_q75_h2_box.webp 1920w" sizes=80vw src=/projects/dns-driveby/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_1920x0_resize_q75_h2_box.webp alt="Tracker meow" title=Tracker width=1920 height=1080></p><p>While I <em>could</em> connect a SIM card module, this adds additional hardware and a cost barrier to my design - and also makes it more easily traceable if discovered.</p><p>So I wondered, would it be possible to use un-authenticated Wi-Fi from coffee shops or setup networks that it drives past to upload wardriving data & GPS coordinates intermittently?</p><h2 id=bypass-captive-wifi-portals-with-dns>Bypass Captive WiFi Portals with DNS <a href=#bypass-captive-wifi-portals-with-dns class=anchor aria-hidden=true></a></h2><p>The answer is yes, but obviously it wasn&rsquo;t as simple that - I found that most of the open networks I encountered had a captive portal that requires you to input an email address or some other nonsense before you can actually connect to the web.</p><p>However, my friend <a href>Kody</a> suggested I look into DNS requests to bypass the captive portal using a well-known technique called <a href>DNS Exfiltration</a>, which allows hackers to sneak sensitive information out of a network by hiding data inside of a domain name instead of a typical web request.</p><p>This works by making a DNS request to a domain name like <code>alexlynd.com</code>, but prepending a subdomain like <code>&lt;password_here>.alexlynd.com</code> - so that way I can retrieve the password (or other sensitive information) on my server, by looking at the nameserver logs.</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_3ab1422439ad7d7d46c6201bdff22a07.webp 480w, /projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_92365523ea32c8fa7c8253e91a05aa96.webp 720w, /projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_a7847644c45f2420a291951250ee0442.webp 1080w, /projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_2730ce139cecb507e9c1939e4b86f9b3.webp 1280w, /projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_b0160b7efa3b07d80c3c1b50f55f31e5.webp 1600w, /projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/projects/dns-driveby/img/dns-exfil_hue35f8fa1c5b49ca65f5b1f592fd97cd6_120310_1920x0_resize_q75_h2_box_3.webp alt="Tracker meow" width=1920 height=1080></p><p>While this is typically used to bypass poorly-configured firewalls for data exfiltration, I can also take advantage of this technique to sneak our wardriving data <strong>into</strong> the network as well!</p><p>Thanks to poor ingress filtering, I discovered that most open networks allowed me to resolve DNS requests without &ldquo;fully connecting&rdquo;.</p><h2 id=canarytokens-as-a-gps-database>CanaryTokens as a GPS Database <a href=#canarytokens-as-a-gps-database class=anchor aria-hidden=true></a></h2><p><a href=https://canarytokens.org>CanaryTokens</a> is an awesome service providing &ldquo;honeypot tokens&rdquo; that make it easy to create bugged documents, images, and other sorts of tokens for ensnaring hackers & creeps on your network.</p><p>Their <a href>DNS token</a> service makes it extremely easy to try out exfiltration without setting up a custom web server, and the dashboard interface also makes it easyto view the exfiltrated data!</p><p>To test this out, I connected to my local coffee shop Wi-Fi from my laptop, without entering my info or leaving the captive portal login, meaning I was unable to access the internet.</p><p>After generating a DNS token (on my phone), I made a request to the unique token url using <code>dig</code> (on my laptop), which successfully resolves!</p><pre><code>dig canarytokens.org/your_token_here NS
</code></pre><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png alt="Tracker meow"></p><p>I also get an email alert that my CanaryToken has been triggered, and a hit on the dashboard monitor.</p><p>In order to exfiltrate data to the dashboard, CanaryTokens specifices we prepend a random 2 digit number with <code>G</code>, and a <a href>base32 encoded subdomain</a>, so I used an online converter to translate <code>meow123</code> to base 32: <code>NVSW65ZRGIZQ</code> and made a request to the following url:</p><pre><code>curl NVSW65ZRGIZQ.G69.canarytokens.org/your_token_here 
</code></pre><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png alt="Tracker meow"></p><p>And it worked! The last step was to create the hardware to log & convert GPS coordinates into base32 encoded strings, and automatically push that data through nearby open Wi-Fi networks.</p><h2 id=esp8266-wardriving-rig-for-10>ESP8266 Wardriving Rig for $10 <a href=#esp8266-wardriving-rig-for-10 class=anchor aria-hidden=true></a></h2><h6 id=breadboarding>Breadboarding <a href=#breadboarding class=anchor aria-hidden=true></a></h6><p>The <a href>ESP8266</a> is my favorite low-cost WiFi microcontroller for its attack & reconnaissance capabilities, and I chose the minimal <a href>ESP-01</a> form-factor to keep my tracker footprint as small as possible.</p><p>Paired with a <a href>NEO-6M GPS module</a>, I started by creating a breadboard prototype to test how many coordinates could be logged to the ESP8266&rsquo;s internal memory.</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_9ed519ce6488b027ca6fff3f5fc6f887.webp 480w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_b81fe7ec7118cfe6d082ce2fea4515c1.webp 720w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_35b0453930a664578b8bed40db05f5b4.webp 1080w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_f40182d2bba965467e99378923416a6e.webp 1280w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_0bfc9d895dd19b38d8956d54514dc12f.webp 1600w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_08910ae0e6ffceb0a1eb563d495847b6.webp 2048w, /projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_2178x0_resize_q75_h2_box.webp 2178w" sizes=80vw src=/projects/dns-driveby/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_2178x0_resize_q75_h2_box.webp alt="Tracker meow" width=2178 height=1225></p><h6 id=memory-management>Memory Management <a href=#memory-management class=anchor aria-hidden=true></a></h6><p>I found that storing GPS coordinates in an array quickly ate up heap space, causing overflows since the ESP8266 only has ???MB of internal RAM - meaning I can only store around ??? coordinates on-hand before it crashes.</p><p>To mitigate this, I implemented a queue that pushes old coordinates to the internal 1KB ROM using the <a href>SPI Flash Filesystem</a> (SPIFFS), which also allows me to save data in case of a power loss or reset. I also reduced GPS polling to gather coordinates every 15 seconds, which allows me to cache ~??? coordinates for up to ??? hours before encountering an open network!</p><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png alt="Tracker meow"></p><h6 id=low-power-hardware>Low-Power Hardware <a href=#low-power-hardware class=anchor aria-hidden=true></a></h6><p>To keep the board powered for long enough to provide intel on Irish&rsquo;s whereabouts, implementing low-power hardware was necessary to conserve battery while his car was sitting idle. Luckily, the ESP8266 comes with a low-power mode that brings power consumption down to around 150μA, which can be invoked with the following function:</p><pre><code>ESP.deepsleep();
</code></pre><p>In order to &ldquo;wake up&rdquo; the ESP8266, a delay is typically used with this function, which grounds the <code>reset</code> pin using <code>GPIO0</code> - but since I wanted to trigger a reset when motion is detected from a shake sensor, this was tricky since the onboard I/O pins are disabled in deep sleep mode.</p><p>Triggering the reset when Irish&rsquo;s car starts up was as simple as adding a shake sensor between <code>reset</code> and <code>ground</code> - but in order to prevent an accidental reset while the device is powered up, I used a <a href>JFET transistor</a> as a <a href>normally-closed switch</a> to electronically &ldquo;disconnect&rdquo; the shake sensor while the device is in motion.</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/reset-circuit_hu00bea80f2e4e311654c5907a1a62fad3_5112_176479af1edd93d6ac9b18f284c5e265.webp 480w, /projects/dns-driveby/img/reset-circuit_hu00bea80f2e4e311654c5907a1a62fad3_5112_647x0_resize_q75_h2_box_3.webp 647w" sizes=80vw src=/projects/dns-driveby/img/reset-circuit_hu00bea80f2e4e311654c5907a1a62fad3_5112_647x0_resize_q75_h2_box_3.webp alt="Tracker meow" width=647 height=364></p><h6 id=final-prototype>Final Prototype <a href=#final-prototype class=anchor aria-hidden=true></a></h6><p>To piece it all together, I soldered all my components on a perfboard, and implemented a cheap BMS using a voltage regulator & an 1800maH LiPo battery that gives me around ??? hours of non-stop reconnaissance (at a current draw around ???mah).</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_3e29f48506e57bbe3b1473f6b546e7e2.webp 480w, /projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_4b477f7cf43afb3d30b8ac4c981f8a10.webp 720w, /projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_5d6997f6d2330ee3fe9f7c5989a6381d.webp 1080w, /projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_98b1f87636d1b3b26e2c4864ff626835.webp 1280w, /projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_b677d94e5347b07f49881d723ac66e5d.webp 1600w, /projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/projects/dns-driveby/img/prototype_hu9611d23a24afafd0a0afdb1b79fd9db4_1575522_1920x0_resize_q75_h2_box_3.webp alt="Tracker meow" width=1920 height=1080></p><table><thead><tr><th>Essential Components</th><th>Notes</th><th>Cost</th></tr></thead><tbody><tr><td><a href>WiFi Microcontroller (ESP8266)</a></td><td>I use an ESP-01 module for this prototype, but any other ESP8266 will work.</td><td>$2</td></tr><tr><td><a href>GPS Module (NEO-6M)</a></td><td></td><td>$3</td></tr></tbody></table><table><thead><tr><th>Other Components</th><th>Notes</th><th>Cost</th></tr></thead><tbody><tr><td><a href>3.7V LiPo Battery</a></td><td></td><td></td></tr><tr><td><a href>LDO</a></td><td></td><td></td></tr><tr><td><a href>Shake Sensor</a></td><td>Wakes up ESP8266 from Deep Sleep when motion is detected</td><td></td></tr><tr><td><a href>JFET (N-Type)</a></td><td>This acts as a &ldquo;switch&rdquo; to prevent accidental resets while chip is powered up.</td><td></td></tr><tr><td><a href>Slide Switch (SPDT)</a></td><td></td><td></td></tr><tr><td><a href>Perfboard</a></td><td></td><td></td></tr></tbody></table><p>To protect the electronics & provide a large enough surface to adhere to Irish&rsquo;s car, I used FreeCAD to whip up a minimal 2-part enclosure that you can <a href>download here</a>.</p><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_9b434988e86aee20654b4622ff169da1.webp 480w, /projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_9d8d2b391e159111e2ce56aaa0188945.webp 720w, /projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_bbd6aba40c008921c3dfef893bc89ad1.webp 1080w, /projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_7bf4b1bf82b82c7168fdc3fa73849d93.webp 1280w, /projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_01985905cfe08d5036000263cb7cee77.webp 1600w, /projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/projects/dns-driveby/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_1920x0_resize_q75_h2_box_3.webp alt="Tracker meow" width=1920 height=1080></p><p><strong>Full assembly guide and DIY kit coming soon.</strong></p><h2 id=tracking-experiment-results>Tracking Experiment Results <a href=#tracking-experiment-results class=anchor aria-hidden=true></a></h2><p>To test out the prototype, I enabled an open Wi-Fi network on my phone and drove around to see if I could get a consistent log of GPS coordinates along my route. Since it&rsquo;s designed to cache data while no open networks are available, I turned off the hotspot at random intervals to see if I could still receive those coordinates.</p><p>I initially faced some issues with the <a href>watchdog timer</a> triggering while it attempted to scan for open networks, and heap overflows while &ldquo;multitasking&rdquo; between GPS logging & creating DNS requests - but eventually was able to get a pretty robust prototype working!</p><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png alt="Tracker meow"></p><p>The next day, Kody, Michael, and I deployed our tracking systems on Irish, each using a different approach and reconnaissance style:</p><ul><li>Michael used off-the shelf trackers and consumer products such as a <a href>Tile tracker</a></li><li>Kody used out-of-the-box hacker hardware and a tricky QR code phishing attack to track Irish using Wi-Fi probes from his phone</li><li>I used my skills as a hardware developer to create a low-cost, virtually untracable implant to give me passive location updates</li></ul><p><img class="img-fluid lazyload blur-up" src=https://raw.githubusercontent.com/AlexLynd/DNS-DriveBy/main/img/DNS-DriveBy.png alt="Tracker meow"></p><p>At the end of the day, I checked my CanaryTokens dashboard and had a couple hundred hits from Irish&rsquo;s excursion around East LA!</p><p>In order to turn this data into something useful, I downloaded the coordinates as a <code>csv</code> file and created a simple Python script to visualize it through <a href>folium</a>.</p><p>Since the implant was placed on Irish&rsquo;s car, this map only provides me with insight to the general areas that he visited - but I was still able to see that he stopped at Forest Lawn, and took a visit to the Glendale Galleria!</p><iframe width=560 height=315 src="https://www.youtube.com/embed/H0Nwff0KDJ0?start=151" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h2 id=implications--future-improvements>Implications & Future Improvements <a href=#implications--future-improvements class=anchor aria-hidden=true></a></h2><h6 id=limitations>Limitations <a href=#limitations class=anchor aria-hidden=true></a></h6><p>While DNS DriveBy doesn&rsquo;t provide real-time GPS updates like an off-the-shelf solution would, my prototype was able to gather equally insightful data on the places Irish visited, for a much cheaper and less traceable footprint - since a SIM card or GPS Tracker UID could potentially be used to determine the original subscriber.</p><p>The trade-off of course is relying on the presence of open Wi-Fi networks to provide telemetry, and the infrequent, intermittent updates - but given that the target (or wardriving neighborhood cat) is driving through somewhat urban areas, the density of open Wi-Fi networks should be modest. If the target is frequenting certain locations, it&rsquo;s also possible to hard-code known credentials for specific home/work networks as well!</p><h6 id=improvements>Improvements <a href=#improvements class=anchor aria-hidden=true></a></h6><p><img class="img-fluid lazyload blur-up" srcset="/projects/dns-driveby/img/pcb-prototype_hu641c7ed52b62535694bd5a211e2615af_53801_6a68031e720c059e7536b5f84bea88e2.webp 480w, /projects/dns-driveby/img/pcb-prototype_hu641c7ed52b62535694bd5a211e2615af_53801_8e837f5f56f81caed2a0d8e97ac84bcf.webp 720w, /projects/dns-driveby/img/pcb-prototype_hu641c7ed52b62535694bd5a211e2615af_53801_800x0_resize_q75_h2_box_3.webp 800w" sizes=80vw src=/projects/dns-driveby/img/pcb-prototype_hu641c7ed52b62535694bd5a211e2615af_53801_800x0_resize_q75_h2_box_3.webp width=800 height=450></p><p>To make the design more robust and easier for beginners to assemble, I started designing a PCB kit that includes all the project components, which can also be used try out some of my other Signals Intelligence projects!</p><p>Using the <a href>D1 Mini</a> ESP8266 form-factor, this design allows for easy plug-and-play expansion with various <a href>D1 hardware add-ons</a>, and also has a 4MB flash chip which can log around ??? more coordinates than the ESP-01.</p><h6 id=conclusion--future-ideas>Conclusion & Future Ideas <a href=#conclusion--future-ideas class=anchor aria-hidden=true></a></h6><p>While this project can be used nefariously, the barrier to entry of creating & configuring one of these devices is a lot of work, and probably not worth the erratic updates for an attacker to want to implant this on your car or person.</p><p>However in scope of the original &ldquo;lazy wardriving&rdquo; PoC, this demo was a success and provides groundwork for my future telemetry-enabled & wireless intel demonstrations! In future iterations, I hope to take this ridiculous project further by removing the GPS, and use <strong>only</strong> a Wi-Fi connection to determine rough location whereabouts, through assisted GPS and online wardriving databases.</p><p>If you want to follow updates on this project and more, check out my <a href>Twitter</a> and consider <a href>donating</a> to support my open-source work!</p></article></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>© 2022 Alex Lynd / LyndLabs</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/about/#contact-me>Contact Me</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin=anonymous defer></script>
<script src=/main.min.162c56a0426544de0d010e66c56e321579655c400c9aae06a6823e7682de379adadf2165bd416fea191e4e7e410fbf1fd2c35a759aa43ff2e3787067669bf81b.js integrity="sha512-FixWoEJlRN4NAQ5mxW4yFXllXEAMmq4GpoI+doLeN5ra3yFlvUFv6hkeTn5BD78f0sNadZqkP/LjeHBnZpv4Gw==" crossorigin=anonymous defer></script>
<script src=/index.min.771f2e9655d5cf51ac648506c3b4967af53322731eaab2224a29c664e5c3075bc26161f50dcdcd2b752770e9cd919c9db9f60f7807453745012c158ee4382730.js integrity="sha512-dx8ullXVz1GsZIUGw7SWevUzInMeqrIiSinGZOXDB1vCYWH1Dc3NK3UncOnNkZydufYPeAdFN0UBLBWO5DgnMA==" crossorigin=anonymous defer></script></body></html>